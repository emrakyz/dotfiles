#!/bin/bash

# Directory where your PDFs are stored
BOOK_DIR="$HOME/downloads/books"

# Directory where thumbnails are stored
THUMBNAIL_DIR="$HOME/downloads/books"

# Open imv and get the selected file
imv -f "$THUMBNAIL_DIR"/*.{png,jpg} | while IFS= read -r line; do
    SELECTED=$(echo "$line" | awk -F' ' '{print $NF}' | awk -F'/' '{print $NF}' | awk -F'.' '{print $1}')

    # Open the selected book with zathura (replace zathura with your preferred viewer if necessary)
    if [ -n "$SELECTED" ]; then
        if [ -f "$BOOK_DIR/$SELECTED".pdf ]; then
            zathura --mode fullscreen "$BOOK_DIR/$SELECTED".pdf &
        elif [ -f "$BOOK_DIR/$SELECTED".epub ]; then
            zathura --mode fullscreen "$BOOK_DIR/$SELECTED".epub &
        else
            echo "No matching PDF or EPUB file found for $SELECTED"
        fi
    fi
done
